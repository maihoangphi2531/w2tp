local maxGold = 99999999 -- GiÃ¡ trá»‹ vÃ ng tá»‘i Ä‘a Ä‘á»ƒ kÃ­ch hoáº¡t dá»‹ch chuyá»ƒn
local player = game:GetService("Players").LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Remote Id tÆ°Æ¡ng á»©ng vá»›i cÃ¡c World (dÃ¹ng cho TeleportToHub)
local remoteId1 = 19 -- World 2 (Remote Id)
local remoteId2 = 20 -- World 1 (Remote Id)

-- PlaceId Ä‘á»ƒ kiá»ƒm tra vá»‹ trÃ­ hiá»‡n táº¡i
local placeId1 = 4310463940 -- World 2
local placeId2 = 4310463616 -- World 1

-- Láº¥y Remote Ä‘á»ƒ teleport
local Shared = ReplicatedStorage:WaitForChild("Shared", 10)
local TeleportRemote = Shared and Shared:WaitForChild("Teleport", 10)
local TeleportToHub = TeleportRemote and TeleportRemote:WaitForChild("TeleportToHub", 10)

-- HÃ m kiá»ƒm tra náº¿u Ä‘ang á»Ÿ PlaceId
local function isInPlace(placeId)
    return game.PlaceId == placeId
end

-- HÃ m kiá»ƒm tra nhÃ¢n váº­t cÃ²n sá»‘ng khÃ´ng
local function isAlive()
    local character = player.Character
    if not character then return false end
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if not humanoid then return false end
    return humanoid.Health > 0
end

-- HÃ m kiá»ƒm tra giÃ¡ trá»‹ vÃ ng
local function getGoldValue()
    local success, goldValue = pcall(function()
        local goldValueObject = player:WaitForChild("PlayerGui")
                                    :WaitForChild("Profile")
                                    :WaitForChild("Currency")
                                    :WaitForChild("Gold")
        return goldValueObject.Value
    end)

    if success then
        return goldValue
    else
        return nil
    end
end

-- HÃ m dá»‹ch chuyá»ƒn Ä‘áº¿n World sá»­ dá»¥ng Remote (thay vÃ¬ TeleportService)
local function teleportToWorld(remoteId, targetPlaceId, maxRetries)
    maxRetries = maxRetries or 10

    for attempt = 1, maxRetries do
        -- Náº¿u Ä‘Ã£ á»Ÿ Ä‘Ãºng nÆ¡i, tráº£ vá» thÃ nh cÃ´ng vÃ  thoÃ¡t
        if isInPlace(targetPlaceId) then
            warn("ÄÃ£ á»Ÿ Ä‘Ãºng Ä‘á»‹a Ä‘iá»ƒm: " .. targetPlaceId)
            return true 
        end

        -- Kiá»ƒm tra nhÃ¢n váº­t cÃ²n sá»‘ng khÃ´ng
        if not isAlive() then
            warn("NhÃ¢n váº­t Ä‘Ã£ cháº¿t, Ä‘á»£i há»“i sinh...")
            task.wait(5)
            continue
        end

        -- Kiá»ƒm tra Remote cÃ³ tá»“n táº¡i khÃ´ng
        if not TeleportToHub then
            warn("KhÃ´ng tÃ¬m tháº¥y TeleportToHub Remote!")
            task.wait(5)
            continue
        end

        warn("Äang thá»­ dá»‹ch chuyá»ƒn Ä‘áº¿n World (Remote Id: " .. remoteId .. "), láº§n thá»­ " .. attempt .. "/" .. maxRetries)
        
        -- Sá»­ dá»¥ng Remote cá»§a game thay vÃ¬ TeleportService
        local success, err = pcall(function()
            TeleportToHub:FireServer(remoteId)
        end)

        if not success then
            warn("Lá»—i khi gá»i TeleportToHub: " .. tostring(err))
        end

        -- Äá»£i má»™t khoáº£ng thá»i gian Ä‘á»ƒ game cÃ³ thá»i gian chuyá»ƒn server
        task.wait(15)

        -- Kiá»ƒm tra láº¡i sau khi chá»
        if isInPlace(targetPlaceId) then
            warn("Dá»‹ch chuyá»ƒn thÃ nh cÃ´ng Ä‘áº¿n " .. targetPlaceId)
            return true
        end
    end

    -- Náº¿u vÃ²ng láº·p káº¿t thÃºc mÃ  khÃ´ng thÃ nh cÃ´ng, thá»±c hiá»‡n kick ngÆ°á»i chÆ¡i
    warn("Dá»‹ch chuyá»ƒn tháº¥t báº¡i sau " .. maxRetries .. " láº§n thá»­. Sáº½ tá»± Ä‘á»™ng kick Ä‘á»ƒ restart.")
    player:Kick("Tá»± Ä‘á»™ng khá»Ÿi Ä‘á»™ng láº¡i: Dá»‹ch chuyá»ƒn tháº¥t báº¡i nhiá»u láº§n.")
    
    return false
end

-- HÃ m Ä‘á»£i cho Ä‘áº¿n khi vÃ ng khÃ´ng cÃ²n lÃ  maxGold (thay vÃ¬ Ä‘á»£i cá»‘ Ä‘á»‹nh 3 phÃºt)
local function waitUntilGoldChanged()
    local maxWaitTime = 1000 -- Tá»‘i Ä‘a 5 phÃºt (300 giÃ¢y) Ä‘á»ƒ trÃ¡nh Ä‘á»£i vÃ´ háº¡n
    local waitedTime = 0
    local checkInterval = 5 -- Kiá»ƒm tra má»—i 5 giÃ¢y
    
    warn("â³ Äang Ä‘á»£i vÃ ng thay Ä‘á»•i (hiá»‡n táº¡i: " .. maxGold .. ")...")
    
    while waitedTime < maxWaitTime do
        task.wait(checkInterval)
        waitedTime = waitedTime + checkInterval
        
        local currentGold = getGoldValue()
        
        if currentGold then
            if currentGold ~= maxGold then
                warn("âœ… VÃ ng Ä‘Ã£ thay Ä‘á»•i! Hiá»‡n táº¡i: " .. currentGold .. " (Ä‘á»£i " .. waitedTime .. "s)")
                return true
            else
                warn("â³ VÃ ng váº«n lÃ  " .. currentGold .. " - Ä‘Ã£ Ä‘á»£i " .. waitedTime .. "s / " .. maxWaitTime .. "s")
            end
        else
            warn("âš ï¸ KhÃ´ng thá»ƒ Ä‘á»c giÃ¡ trá»‹ vÃ ng, tiáº¿p tá»¥c Ä‘á»£i...")
        end
    end
    
    warn("âš ï¸ ÄÃ£ Ä‘á»£i quÃ¡ " .. maxWaitTime .. "s mÃ  vÃ ng váº«n khÃ´ng Ä‘á»•i. Tiáº¿p tá»¥c vá» World 1...")
    return false
end

-- HÃ m tá»•ng há»£p xá»­ lÃ½ dá»‹ch chuyá»ƒn
local function handleTeleport()
    local currentGold = getGoldValue()
    if currentGold and currentGold >= maxGold then
        warn("ğŸ’° VÃ ng Ä‘Ã£ Ä‘áº§y (" .. currentGold .. "), báº¯t Ä‘áº§u quÃ¡ trÃ¬nh dá»‹ch chuyá»ƒn.")
        
        -- Thá»­ dá»‹ch chuyá»ƒn Ä‘áº¿n World 2 (sá»­ dá»¥ng Remote)
        local success1 = teleportToWorld(remoteId1, placeId1, 10)

        -- Chá»‰ tiáº¿p tá»¥c náº¿u viá»‡c dá»‹ch chuyá»ƒn Ä‘áº§u tiÃªn thÃ nh cÃ´ng
        if success1 then
            warn("âœ… ÄÃ£ Ä‘áº¿n World 2. Äang Ä‘á»£i vÃ ng thay Ä‘á»•i...")
            
            -- Äá»£i cho Ä‘áº¿n khi vÃ ng khÃ´ng cÃ²n lÃ  maxGold
            waitUntilGoldChanged()
            
            warn("ğŸ”„ Chuáº©n bá»‹ dá»‹ch chuyá»ƒn vá» World 1...")
            
            -- Dá»‹ch chuyá»ƒn vá» World 1
            teleportToWorld(remoteId2, placeId2, 10)
        else
            warn("âŒ KhÃ´ng thá»ƒ dá»‹ch chuyá»ƒn Ä‘áº¿n World 2. Há»§y bá» quÃ¡ trÃ¬nh.")
        end
    end
end

-- Cháº¡y trong má»™t vÃ²ng láº·p Ä‘á»ƒ liÃªn tá»¥c kiá»ƒm tra vÃ ng
while true do
    pcall(handleTeleport)
    task.wait(10)
end
